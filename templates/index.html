<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>卡拉OK歌曲搜尋</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body class="bg-gray-100">
    <div id="app" class="container mx-auto px-4 py-8">
        <div class="max-w-3xl mx-auto">
            <!-- 標題 -->
            <h1 class="text-3xl font-bold text-center mb-8 text-gray-800">
                卡拉OK歌曲搜尋
            </h1>

            <!-- 搜尋框 -->
            <div class="mb-8">
                <div class="flex gap-4">
                    <input 
                        type="text" 
                        v-model="keyword"
                        @keyup.enter="searchSongs"
                        placeholder="輸入歌名或歌手..."
                        class="flex-1 px-4 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500"
                    >
                    <button 
                        @click="searchSongs"
                        class="px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500"
                        :disabled="isLoading"
                    >
                        <span v-if="!isLoading">搜尋</span>
                        <span v-else>搜尋中...</span>
                    </button>
                </div>
            </div>

            <!-- 錯誤提示 -->
            <div v-if="error" class="mb-4 p-4 bg-red-100 text-red-700 rounded-lg">
                {{ error }}
            </div>

            <!-- 搜尋結果 -->
            <div v-if="results.length > 0" class="space-y-4">
                <div class="bg-white rounded-lg shadow-md p-4" v-for="song in results" :key="song.編號">
                    <div class="flex justify-between items-start">
                        <div>
                            <h3 class="text-xl font-semibold text-gray-800">{{ song.歌名 }}</h3>
                            <p class="text-gray-600">{{ song.歌手 }}</p>
                            <div class="mt-2 space-x-2">
                                <span class="inline-block px-2 py-1 text-sm bg-gray-100 text-gray-700 rounded">
                                    編號: {{ song.編號 }}
                                </span>
                                <span class="inline-block px-2 py-1 text-sm bg-gray-100 text-gray-700 rounded">
                                    {{ song.公司 }}
                                </span>
                            </div>
                        </div>
                        <a 
                            v-if="song.youtubeID"
                            :href="'https://www.youtube.com/watch?v=' + song.youtubeID"
                            target="_blank"
                            class="px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600"
                        >
                            試聽
                        </a>
                    </div>
                </div>
            </div>

            <!-- 無結果提示 -->
            <div 
                v-if="results.length === 0 && !error && !isLoading && hasSearched" 
                class="text-center py-8 text-gray-500"
            >
                沒有找到相關歌曲
            </div>
        </div>
    </div>

    <script>
        new Vue({
            el: '#app',
            data: {
                keyword: '',
                results: [],
                error: null,
                isLoading: false,
                hasSearched: false
            },
            methods: {
                async searchSongs() {
                    if (!this.keyword.trim()) {
                        this.error = '請輸入搜尋關鍵字';
                        return;
                    }

                    this.error = null;
                    this.isLoading = true;
                    this.hasSearched = true;

                    try {
                        const response = await axios.get(`http://localhost:5000/api/search`, {
                            params: { keyword: this.keyword }
                        });
                        
                        if (response.data.success) {
                            this.results = response.data.data;
                        } else {
                            this.error = response.data.error || '搜尋失敗';
                        }
                    } catch (err) {
                        this.error = err.response?.data?.error || '搜尋過程發生錯誤';
                        this.results = [];
                    } finally {
                        this.isLoading = false;
                    }
                }
            }
        });
    </script>
</body>
</html> 